default_environment: dev

project_id: lite-data-stack-bigquery

plugins:
  extractors:
  - name: tap-github
    variant: meltanolabs
    pip_url: meltanolabs-tap-github
    config:
      auth_token: $TAP_GITHUB_AUTH_TOKEN
      repositories:
        - blueprint-data/lite-data-stack-postgres
      stream_options:
        milestones:
          state: open
    select:
    - repositories.*
    - branches.*
    - commits.*
    - pull_request_commits.*


  loaders:
  - name: target-jsonl
    variant: andyh1203
    pip_url: target-jsonl
  - name: target-bigquery
    variant: z3z1ma
    pip_url: git+https://github.com/z3z1ma/target-bigquery.git
    config:
      project: ${TARGET_BIGQUERY_PROJECT}
      dataset: ${MELTANO_ENVIRONMENT}_${MELTANO_EXTRACTOR_NAMESPACE}
      location: ${TARGET_BIGQUERY_LOCATION}
      credentials_path: ${TARGET_BIGQUERY_CREDENTIALS_PATH}
      denormalized: false
      generate_view: true

environments:
- name: dev
- name: ci
- name: prod